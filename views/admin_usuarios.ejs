<!DOCTYPE html>
<html lang="es">
<%- include('./plantilla/cabecera', {tituloWeb: 'CarPop - Admin. usuarios'}) %>
<body class="bg-info">

    <section class="container-fluid text-center text-sm-start align-items-center">
        <div class="row bg-dark">
            <div class="col">
                <div class="container">
                    <%- include('./plantilla/admin_nav') %> 
                </div>
            </div>
        </div>
        <div class="row bg-light m-2 my-3">
            <div class="col p-2">
                <div class="bg-light px-1 table-responsive">
                    <table class="table table-sm table-hover align-middle">
                        <thead>
                            <tr>
                                <th scope="col">ID Usuario</th>
                                <th scope="col">Nº&nbsp;anuncios</th>
                                <th scope="col">Nombre</th>
                                <th scope="col">Apellido</th>
                                <th scope="col">Correo</th>
                                <th scope="col">Teléfono</th>
                                <th scope="col">Dirección</th>
                                <th scope="col">Administrador</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (usuarios.length>0) { %>
                                <% usuarios.forEach(usuario => { %>
                                    <% let contAnuncios=0; %> 
                                    <tr>
                                        <td><%= usuario._id %></td>
                                        <td>
                                            <% anuncios.forEach(anuncio => { %>
                                                <% if (anuncio.id_usuario == usuario._id) { %>
                                                    <% contAnuncios++; %> 
                                                <% } %>
                                            <% }) %>
                                            <%= contAnuncios %> 
                                        </td>
                                        <td><%= usuario.nombre %></td>
                                        <td><%= usuario.apellido %></td>
                                        <td><%= usuario.correo %></td>
                                        <td><%= usuario.telefono %></td>
                                        <td><%= usuario.direccion %></td>
                                        <td>
                                            <% if (usuario.admin) { %>
                                                <%= 'Si' %> 
                                            <% } else { %>
                                                <%= 'No' %>
                                            <% }%>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

</body>
</html>